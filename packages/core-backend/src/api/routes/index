import { Router } from "express"
import authRoutes from "./member/auth"
import {unauthenticatedUserRoutes} from "./member/users/index"
import middlewares from "../middlewares"
import invites, { unauthenticatedInviteRoutes } from "./member/invites"
// import apps from "./apps"
// import components from "./member/components"
// import search from "./member/search"
// import teams from "./member/teams"
// import organisation from "./member/organisation"

export default (app, container, config) => {
  const route = Router()
  app.use("/v1",route)
  // const adminCors = config.admin_cors || ""
  // route.use(
  //   cors({
  //     origin: parseCorsOrigins(adminCors),
  //     credentials: true,
  //   })
  // )

  // Allows unathenticated requests to the /users endpoint for creating user signups
  
  authRoutes(route)
  unauthenticatedUserRoutes(route)
  route.use(middlewares.registeredLoggedinUser)
  unauthenticatedInviteRoutes(route)

  // Authenticated routes
  route.use(middlewares.authenticate())
  route.use(middlewares.registeredLoggedinUser)

  apps(route)
  components(route)
  invites(route)
  search(route)
  teams(route)
  organisation(route)

  // users(route)
  return app
}